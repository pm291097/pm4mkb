"""
Enhanced visualization module for PM4MKB.
Version 2.1 with ProcessStandard and enhanced conformance analysis.
"""

from .conformance import ConformanceAnalyzer
from .process_standard import ProcessStandard, ConformanceCategory, create_standard_from_data

__all__ = [
    'ConformanceAnalyzer',
    'ProcessStandard',
    'ConformanceCategory',
    'create_standard_from_data'
]

__version__ = '2.1.0'
      self.last_output_path = output_path


    def get_html(self):
        """Get the last generated HTML content."""
        # Check if HTML is stored after analyze
        if hasattr(self, '_last_html'):
            return self._last_html
        elif hasattr(self, 'html_content'):
            return self.html_content
        elif hasattr(self, 'last_output_path') and os.path.exists(self.last_output_path):
            # Read from the last saved file
            with open(self.last_output_path, 'r', encoding='utf-8') as f:
                return f.read()
        return None
    
    def save_html(self, filepath):
        """Save the last analysis to HTML file."""
        html = self.get_html()
        if html:
            try:
                with open(filepath, 'w', encoding='utf-8') as f:
                    f.write(html)
                return True
            except Exception as e:
                print(f"Error saving HTML: {e}")
                return False
        return False

          self._last_html = html_string
